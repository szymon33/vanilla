var App,Dropdown,Tag,addClass,addEventListener,forEach,ready,removeClass;forEach=Function.prototype.call.bind(Array.prototype.forEach),ready=function(a){return"loading"!==document.readyState?a():document.addEventListener?document.addEventListener("DOMContentLoaded",a):document.attachEvent("onreadystatechange",function(){return"loading"!==document.readyState?a():void 0})},addEventListener=function(a,b,c){return a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,function(){return c.call(a)})},addClass=function(a,b){return a.classList?a.classList.add(b):a.className+=" "+b},removeClass=function(a,b){var c;return c=function(a,b){a.classList?a.classList.remove(b):a.className&&(a.className=a.className.replace(new RegExp("(^|\\b)"+b.split(" ").join("|")+"(\\b|$)","gi")," "))},a.length?forEach(a,function(a){return c(a,b)}):c(a,b)},App=function(){return this.selected=null,forEach(document.querySelectorAll("form.custom select"),function(a){return function(b){return b.style.display="none",new Dropdown(a,b)}}(this)),addEventListener(document,"click",function(a){return function(){a.selected&&(removeClass(a.selected,"open"),a.selected=null)}}(this))},App.prototype.select=function(a){a===this.selected?(removeClass(a,"open"),this.selected=null):(this.selected&&removeClass(this.selected,"open"),addClass(a,"open"),this.selected=a)},Tag=function(a){return this.$subject=a,addClass(this.$subject,"selected"),this.$container=document.getElementById("tags"),this.$el=this.el(),this.$container.appendChild(this.$el),this},Tag.prototype.el=function(){var a;return a=document.createElement("a"),a.className="dropdown-tag",a.innerHTML=this.$subject.innerHTML,a.href="#",addEventListener(a,"click",function(a){return function(b){return b.preventDefault(),a.destroy()}}(this)),a},Tag.prototype.destroy=function(){return removeClass(this.$subject,"selected"),this.$container.removeChild(this.$el),this.onDestroy(this)},Dropdown=function(a,b){return this.collection=a,this.tags=[],this.type=b.getAttribute("multiple")||"single",this.defaultPrompt=b.dataset.prompt||"Choose...",this.$el=this.el(),this.$dropdown=this.dropdown(),this.$pilot=this.pilot(),forEach(b.querySelectorAll("option"),function(a){return function(b){return a.$dropdown.appendChild(a.buildItem(b))}}(this)),this.$el.appendChild(this.$pilot),this.$el.appendChild(this.$dropdown),b.parentNode.appendChild(this.$el),this.setPilot(),this},Dropdown.prototype.el=function(){var a;return a=document.createElement("div"),a.className="custom-dropdown-area",a},Dropdown.prototype.dropdown=function(){var a;return a=document.createElement("ul"),a.className="f-dropdown custom-dropdown-options",a},Dropdown.prototype.pilot=function(){var a;return a=document.createElement("a"),a.className="custom-dropdown-button",a.href="#",addEventListener(a,"click",function(a){return function(b){return b.preventDefault(),b.stopPropagation(),a.collection.select(a.$dropdown)}}(this)),a},Dropdown.prototype.setPilot=function(){void 0!==this.$pilot.textContent?this.$pilot.textContent=this.calculatePrompt():this.$pilot.innerText=this.calculatePrompt()},Dropdown.prototype.calculatePrompt=function(){var a,b;switch(a=this.tags.length){case 0:return this.defaultPrompt;case 1:return b=this.tags[0].$el,b.textContent||b.innerText;default:return a.toString()+" items"}},Dropdown.prototype.buildItem=function(a){var b;return b=document.createElement("li"),b.className="option-item",b.innerHTML=a.innerHTML,a.getAttribute("selected")&&this.addTag(b),addEventListener(b,"click",function(a){return function(b){var c;return b.preventDefault(),b.stopPropagation(),"single"===a.type&&(c=a.tags[0],c&&c.$subject!==b.target&&c.destroy()),a.toggleTag(b.target)}}(this)),b},Dropdown.prototype.findTag=function(a){var b,c,d,e;for(d=this.tags,b=0,c=d.length;c>b;b++)if(e=d[b],e.$subject===a)return e;return null},Dropdown.prototype.addToTags=function(a){return this.tags.push(a),this.setPilot()},Dropdown.prototype.removeFromTags=function(a){var b;return b=this.tags.indexOf(a),b>-1&&this.tags.splice(b,1),this.setPilot()},Dropdown.prototype.toggleTag=function(a){var b;return b=this.findTag(a),b?b.destroy():this.addTag(a)},Dropdown.prototype.addTag=function(a){var b;return b=new Tag(a),b.onDestroy=function(a){return function(b){return a.removeFromTags(b)}}(this),this.addToTags(b)},ready(function(){return new App});